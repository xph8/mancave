#---------------------------------------------
# behaviour
#---------------------------------------------

set -g default-terminal "${TERM}"

# start window numbering from 1
set -g base-index 1
set -g renumber-windows on

# auto rename windows
set-option -g automatic-rename on

set -g pane-border-indicators colour

# do not show status bar if there is only one window
set -g status off
set-hook -g after-new-window      'if "[ #{session_windows} -gt 1 ]" "set status on"'
set-hook -g after-kill-pane       'if "[ #{session_windows} -lt 2 ]" "set status off"'
set-hook -g pane-exited           'if "[ #{session_windows} -lt 2 ]" "set status on"'
set-hook -g window-layout-changed 'if "[ #{session_windows} -lt 2 ]" "set status off"'

#---------------------------------------------
# style
#---------------------------------------------

# true colour
set -ga terminal-overrides ",*:Tc"

# colours of bottom bar
set -g status-style fg="#45475a",bg="#313244"

# colours of message bar
set -g message-style fg="#b4befe",bg="#313244"

# status bar content
set-option -g status-position bottom
set-option -g status-left-length 20
set-option -g status-left " "
set-option -g status-right "#{prefix_highlight} #[fg=#b4befe]󰠿 #{session_name} "

# window
set -g window-status-format "#[fg=#313244,bg=black,nobold,noitalics,nounderscore] #[fg=white,bg=black]#I #[fg=white,bg=black,nobold,noitalics,nounderscore] #[fg=white,bg=black]#W #F #[fg=black,bg=#313244,nobold,noitalics,nounderscore]"
set -g window-status-current-format "#[fg=#313244,bg=#b4befe,nobold,noitalics,nounderscore] #[fg=black,bg=#b4befe]#I #[fg=black,bg=#b4befe,nobold,noitalics,nounderscore] #[fg=black,bg=#b4befe]#W #F #[fg=#b4befe,bg=#313244,nobold,noitalics,nounderscore]"
set -g window-status-separator ""  # elimiate extra space

# bar
set -g pane-border-style fg="#45475a"
set -g pane-active-border-style fg="#b4befe"

#---------------------------------------------
# commands
#---------------------------------------------

set -g mouse on

# change prefix to ctrl-a
set -g prefix C-a
unbind C-b
bind-key C-a send-prefix

# C-a-C-a to send C-a to term
bind C-a send-prefix

# C-r to reload config
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display 'sourced config'

# vim-like resize for panes
bind -r j resize-pane -D 5
bind -r k resize-pane -U 5
bind -r l resize-pane -R 5
bind -r h resize-pane -L 5

# maximise pane
bind -r m resize-pane -Z

# split windows with - and |
unbind '"'
bind - split-window -v
unbind %
bind '\' split-window -h

#---------------------------------------------
# plugin configurations
#---------------------------------------------

# +--- tmux-prefix-highlight ---+
set -g @prefix_highlight_fg "black"
set -g @prefix_highlight_bg "#b4befe"

#---------------------------------------------
# plugins
#---------------------------------------------

# https://github.com/tmux-plugins/tpm/issues/67
set-environment -g PATH "/usr/local/bin:/bin:/usr/bin"

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# initialize TMUX plugin manager, must be at the very bottom of tmux.conf
run '~/.config/tmux/plugins/tpm/tpm'
