#!/bin/sh

exit 0  # FIXME move all zsh files to .config/zsh?

# https://github.com/sorin-ionescu/prezto#installation

if [[ $0 != /bin/zsh ]]; then
    {{- if eq .chezmoi.os "linux" }}
    dnf install zsh
    {{- end }}

    {{- if eq .chezmoi.os "darwin" }}
    brew install zsh
    {{- end }}

    chsh -s /bin/zsh
fi

if [ -d "$XDG_CONFIG_HOME/zsh/.zprezto" ]; then
    exit 0  # prezto is already installed
fi

# clone preto repository
git clone --recursive https://github.com/sorin-ionescu/prezto.git $HOME/.config}/zsh/.zprezto

# link prezto files
setopt EXTENDED_GLOB
for rcfile in "${ZDOTDIR:-$HOME}"/.zprezto/runcoms/^README.md(.N); do
  ln -s "$rcfile" "${ZDOTDIR:-$HOME}/.${rcfile:t}"
done
